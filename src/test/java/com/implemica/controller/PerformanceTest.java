package com.implemica.controller;

import com.implemica.controller.util.TestFxBaseBuilder;
import org.junit.jupiter.api.Test;

public class PerformanceTest extends TestFxBaseBuilder {

   @Test
   void simpleOperationTests() {
      doTest("2+", "2 + ", "2");
      doTest("3+++++", "3 + ", "3");
      doTest("5-----", "5 - ", "5");
      doTest("8×××××", "8 × ", "8");
      doTest("12÷÷÷÷÷", "12 ÷ ", "12");
      doTest("9÷×-+-×÷×-++-×+", "9 + ", "9");
      doTest("52--+÷×-+-÷×-+-÷", "52 ÷ ", "52");
      doTest("12+×÷×-+-×÷÷×÷××÷-+-×÷", "12 ÷ ", "12");
      doTest("2++++=", "", "4");
      doTest("4----=", "", "0");
      doTest("8××××=", "", "64");
      doTest("100÷÷÷÷÷=", "", "1");
   }

   @Test
   void plusOperationTest() {
      doTest("2+2=", "", "4");
      doTest("7+3=", "", "10");
      doTest("1+8=", "", "9");
      doTest("5+6=", "", "11");
      doTest("3+9=", "", "12");

      doTest("0+0=", "", "0");
      doTest("1+0=", "", "1");
      doTest("8+0=", "", "8");
      doTest("0+5=", "", "5");
      doTest("0+3=", "", "3");

      doTest("2+5", "2 + ", "5");
      doTest("5+3", "5 + ", "3");
      doTest("2+3", "2 + ", "3");
      doTest("2+8", "2 + ", "8");
      doTest("1+2", "1 + ", "2");

      doTest("0+0", "0 + ", "0");
      doTest("1+0", "1 + ", "0");
      doTest("5+0", "5 + ", "0");
      doTest("0+2", "0 + ", "2");
      doTest("0+6", "0 + ", "6");

      doTest("0+", "0 + ", "0");
      doTest("2+", "2 + ", "2");
      doTest("3+", "3 + ", "3");
      doTest("9+", "9 + ", "9");
      doTest("8+", "8 + ", "8");

      doTest("+1", "0 + ", "1");
      doTest("+5", "0 + ", "5");
      doTest("+9", "0 + ", "9");
      doTest("+7", "0 + ", "7");
      doTest("+3", "0 + ", "3");

      doTest("+", "0 + ", "0");

      doTest("1+=", "", "2");
      doTest("5+=", "", "10");
      doTest("3+=", "", "6");
      doTest("2+=", "", "4");
      doTest("7+=", "", "14");

      doTest("+7=", "", "7");
      doTest("+2=", "", "2");
      doTest("+5=", "", "5");
      doTest("+9=", "", "9");
      doTest("+1=", "", "1");

      doTest("1+5+", "1 + 5 + ", "6");
      doTest("2+9+", "2 + 9 + ", "11");
      doTest("3+8+", "3 + 8 + ", "11");
      doTest("4+7+", "4 + 7 + ", "11");
      doTest("5+6+", "5 + 6 + ", "11");

      doTest("2+3+=", "", "10");
      doTest("9+2+=", "", "22");
      doTest("5+7+=", "", "24");
      doTest("6+4+=", "", "20");
      doTest("7+6+=", "", "26");

      doTest("1+1+2=", "", "4");
      doTest("6+2+2=", "", "10");
      doTest("1+7+3=", "", "11");
      doTest("0+2+8=", "", "10");
      doTest("5+9+3=", "", "17");

      doTest("2+4=+5", "6 + ", "5");
      doTest("3+3=+7", "6 + ", "7");
      doTest("5+9=+6", "14 + ", "6");
      doTest("8+5=+4", "13 + ", "4");
      doTest("7+1=+3", "8 + ", "3");

      doTest("7+5=+", "12 + ", "12");
      doTest("4+3=+", "7 + ", "7");
      doTest("2+2=+", "4 + ", "4");
      doTest("8+8=+", "16 + ", "16");
      doTest("6+1=+", "7 + ", "7");

      doTest("3+1=+=", "", "8");
      doTest("5+5=+=", "", "20");
      doTest("8+3=+=", "", "22");
      doTest("4+8=+=", "", "24");
      doTest("1+4=+=", "", "10");

      doTest("5n+3=", "", "-2");
      doTest("1n+4=", "", "3");
      doTest("6n+2=", "", "-4");
      doTest("8n+7=", "", "-1");
      doTest("7n+6=", "", "-1");

      doTest("4+4n=", "", "0");
      doTest("2+7n=", "", "-5");
      doTest("8+3n=", "", "5");
      doTest("2+6n=", "", "-4");
      doTest("4+7n=", "", "-3");

      doTest("0.1+1=", "", "1,1");
      doTest("2.5+5=", "", "7,5");
      doTest("8.2+9=", "", "17,2");
      doTest("4.3+4=", "", "8,3");
      doTest("7.5+6=", "", "13,5");

      doTest("7+1.2=", "", "8,2");
      doTest("2+3.5=", "", "5,5");
      doTest("4+5.6=", "", "9,6");
      doTest("5+7.8=", "", "12,8");
      doTest("3+9.1=", "", "12,1");
   }

   @Test
   void subtractOperationTest() {
      doTest("2-2=", "", "0");
      doTest("7-3=", "", "4");
      doTest("1-8=", "", "-7");
      doTest("5-6=", "", "-1");
      doTest("3-9=", "", "-6");

      doTest("0-0=", "", "0");
      doTest("1-0=", "", "1");
      doTest("8-0=", "", "8");
      doTest("0-5=", "", "-5");
      doTest("0-3=", "", "-3");

      doTest("2-5", "2 - ", "5");
      doTest("5-3", "5 - ", "3");
      doTest("2-3", "2 - ", "3");
      doTest("2-8", "2 - ", "8");
      doTest("1-2", "1 - ", "2");

      doTest("0-0", "0 - ", "0");
      doTest("1-0", "1 - ", "0");
      doTest("5-0", "5 - ", "0");
      doTest("0-2", "0 - ", "2");
      doTest("0-6", "0 - ", "6");

      doTest("0-", "0 - ", "0");
      doTest("2-", "2 - ", "2");
      doTest("3-", "3 - ", "3");
      doTest("9-", "9 - ", "9");
      doTest("8-", "8 - ", "8");

      doTest("-1", "0 - ", "1");
      doTest("-5", "0 - ", "5");
      doTest("-9", "0 - ", "9");
      doTest("-7", "0 - ", "7");
      doTest("-3", "0 - ", "3");

      doTest("-", "0 - ", "0");

      doTest("1-=", "", "0");
      doTest("5-=", "", "0");
      doTest("3-=", "", "0");
      doTest("2-=", "", "0");
      doTest("7-=", "", "0");

      doTest("-7=", "", "-7");
      doTest("-2=", "", "-2");
      doTest("-5=", "", "-5");
      doTest("-9=", "", "-9");
      doTest("-1=", "", "-1");

      doTest("1-5-", "1 - 5 - ", "-4");
      doTest("2-9-", "2 - 9 - ", "-7");
      doTest("3-8-", "3 - 8 - ", "-5");
      doTest("4-7-", "4 - 7 - ", "-3");
      doTest("5-6-", "5 - 6 - ", "-1");

      doTest("2-3-=", "", "0");
      doTest("9-2-=", "", "0");
      doTest("5-7-=", "", "0");
      doTest("6-4-=", "", "0");
      doTest("7-6-=", "", "0");

      doTest("1-1-2=", "", "-2");
      doTest("6-2-2=", "", "2");
      doTest("1-7-3=", "", "-9");
      doTest("0-2-8=", "", "-10");
      doTest("5-9-3=", "", "-7");

      doTest("2-4=-5", "-2 - ", "5");
      doTest("3-3=-7", "0 - ", "7");
      doTest("5-9=-6", "-4 - ", "6");
      doTest("8-5=-4", "3 - ", "4");
      doTest("7-1=-3", "6 - ", "3");

      doTest("7-5=-", "2 - ", "2");
      doTest("4-3=-", "1 - ", "1");
      doTest("2-2=-", "0 - ", "0");
      doTest("8-8=-", "0 - ", "0");
      doTest("6-1=-", "5 - ", "5");

      doTest("3-1=-=", "", "0");
      doTest("5-5=-=", "", "0");
      doTest("8-3=-=", "", "0");
      doTest("4-8=-=", "", "0");
      doTest("1-4=-=", "", "0");

      doTest("5n-3=", "", "-8");
      doTest("1n-4=", "", "-5");
      doTest("6n-2=", "", "-8");
      doTest("8n-7=", "", "-15");
      doTest("7n-6=", "", "-13");

      doTest("4-4n=", "", "8");
      doTest("2-7n=", "", "9");
      doTest("8-3n=", "", "11");
      doTest("2-6n=", "", "8");
      doTest("4-7n=", "", "11");

      doTest("0.1-1=", "", "-0,9");
      doTest("2.5-5=", "", "-2,5");
      doTest("8.2-9=", "", "-0,8");
      doTest("4.3-4=", "", "0,3");
      doTest("7.5-6=", "", "1,5");

      doTest("7-1.2=", "", "5,8");
      doTest("2-3.5=", "", "-1,5");
      doTest("4-5.6=", "", "-1,6");
      doTest("5-7.8=", "", "-2,8");
      doTest("3-9.1=", "", "-6,1");
   }

   @Test
   void multiplyOperationTest() {
      doTest("2×2=", "", "4");
      doTest("7×3=", "", "21");
      doTest("1×8=", "", "8");
      doTest("5×6=", "", "30");
      doTest("3×9=", "", "27");

      doTest("0×0=", "", "0");
      doTest("1×0=", "", "0");
      doTest("8×0=", "", "0");
      doTest("0×5=", "", "0");
      doTest("0×3=", "", "0");

      doTest("2×5", "2 × ", "5");
      doTest("5×3", "5 × ", "3");
      doTest("2×3", "2 × ", "3");
      doTest("2×8", "2 × ", "8");
      doTest("1×2", "1 × ", "2");

      doTest("0×0", "0 × ", "0");
      doTest("1×0", "1 × ", "0");
      doTest("5×0", "5 × ", "0");
      doTest("0×2", "0 × ", "2");
      doTest("0×6", "0 × ", "6");

      doTest("0×", "0 × ", "0");
      doTest("2×", "2 × ", "2");
      doTest("3×", "3 × ", "3");
      doTest("9×", "9 × ", "9");
      doTest("8×", "8 × ", "8");

      doTest("×1", "0 × ", "1");
      doTest("×5", "0 × ", "5");
      doTest("×9", "0 × ", "9");
      doTest("×7", "0 × ", "7");
      doTest("×3", "0 × ", "3");

      doTest("×", "0 × ", "0");

      doTest("1×=", "", "1");
      doTest("5×=", "", "25");
      doTest("3×=", "", "9");
      doTest("2×=", "", "4");
      doTest("7×=", "", "49");

      doTest("×7=", "", "0");
      doTest("×2=", "", "0");
      doTest("×5=", "", "0");
      doTest("×9=", "", "0");
      doTest("×1=", "", "0");

      doTest("1×5×", "1 × 5 × ", "5");
      doTest("2×9×", "2 × 9 × ", "18");
      doTest("3×8×", "3 × 8 × ", "24");
      doTest("4×7×", "4 × 7 × ", "28");
      doTest("5×6×", "5 × 6 × ", "30");

      doTest("2×3×=", "", "36");
      doTest("9×2×=", "", "324");
      doTest("5×7×=", "", "1 225");
      doTest("6×4×=", "", "576");
      doTest("7×6×=", "", "1 764");

      doTest("1×1×2=", "", "2");
      doTest("6×2×2=", "", "24");
      doTest("1×7×3=", "", "21");
      doTest("0×2×8=", "", "0");
      doTest("5×9×3=", "", "135");

      doTest("2×4=×5", "8 × ", "5");
      doTest("3×3=×7", "9 × ", "7");
      doTest("5×9=×6", "45 × ", "6");
      doTest("8×5=×4", "40 × ", "4");
      doTest("7×1=×3", "7 × ", "3");

      doTest("7×5=×", "35 × ", "35");
      doTest("4×3=×", "12 × ", "12");
      doTest("2×2=×", "4 × ", "4");
      doTest("8×8=×", "64 × ", "64");
      doTest("6×1=×", "6 × ", "6");

      doTest("3×1=×=", "", "9");
      doTest("5×5=×=", "", "625");
      doTest("8×3=×=", "", "576");
      doTest("4×8=×=", "", "1 024");
      doTest("1×4=×=", "", "16");

      doTest("5n×3=", "", "-15");
      doTest("1n×4=", "", "-4");
      doTest("6n×2=", "", "-12");
      doTest("8n×7=", "", "-56");
      doTest("7n×6=", "", "-42");

      doTest("4×4n=", "", "-16");
      doTest("2×7n=", "", "-14");
      doTest("8×3n=", "", "-24");
      doTest("2×6n=", "", "-12");
      doTest("4×7n=", "", "-28");

      doTest("0.1×1=", "", "0,1");
      doTest("2.5×5=", "", "12,5");
      doTest("8.2×9=", "", "73,8");
      doTest("4.3×4=", "", "17,2");
      doTest("7.5×6=", "", "45");

      doTest("7×1.2=", "", "8,4");
      doTest("2×3.5=", "", "7");
      doTest("4×5.6=", "", "22,4");
      doTest("5×7.8=", "", "39");
      doTest("3×9.1=", "", "27,3");
   }

   @Test
   void divideOperationTest() {
      doTest("2÷2=", "", "1");
      doTest("7÷3=", "", "2,333333333333333");
      doTest("1÷8=", "", "0,125");
      doTest("5÷6=", "", "0,8333333333333333");
      doTest("3÷9=", "", "0,3333333333333333");

      doTest("0÷5=", "", "0");
      doTest("0÷3=", "", "0");

      doTest("2÷5", "2 ÷ ", "5");
      doTest("5÷3", "5 ÷ ", "3");
      doTest("2÷3", "2 ÷ ", "3");
      doTest("2÷8", "2 ÷ ", "8");
      doTest("1÷2", "1 ÷ ", "2");

      doTest("0÷0", "0 ÷ ", "0");
      doTest("1÷0", "1 ÷ ", "0");
      doTest("5÷0", "5 ÷ ", "0");
      doTest("0÷2", "0 ÷ ", "2");
      doTest("0÷6", "0 ÷ ", "6");

      doTest("0÷", "0 ÷ ", "0");
      doTest("2÷", "2 ÷ ", "2");
      doTest("3÷", "3 ÷ ", "3");
      doTest("9÷", "9 ÷ ", "9");
      doTest("8÷", "8 ÷ ", "8");

      doTest("÷1", "0 ÷ ", "1");
      doTest("÷5", "0 ÷ ", "5");
      doTest("÷9", "0 ÷ ", "9");
      doTest("÷7", "0 ÷ ", "7");
      doTest("÷3", "0 ÷ ", "3");

      doTest("÷", "0 ÷ ", "0");

      doTest("1÷=", "", "1");
      doTest("5÷=", "", "1");
      doTest("3÷=", "", "1");
      doTest("2÷=", "", "1");
      doTest("7÷=", "", "1");

      doTest("÷7=", "", "0");
      doTest("÷2=", "", "0");
      doTest("÷5=", "", "0");
      doTest("÷9=", "", "0");
      doTest("÷1=", "", "0");

      doTest("1÷5÷", "1 ÷ 5 ÷ ", "0,2");
      doTest("2÷9÷", "2 ÷ 9 ÷ ", "0,2222222222222222");
      doTest("3÷8÷", "3 ÷ 8 ÷ ", "0,375");
      doTest("4÷7÷", "4 ÷ 7 ÷ ", "0,5714285714285714");
      doTest("5÷6÷", "5 ÷ 6 ÷ ", "0,8333333333333333");

      doTest("2÷3÷=", "", "1");
      doTest("9÷2÷=", "", "1");
      doTest("5÷7÷=", "", "1");
      doTest("6÷4÷=", "", "1");
      doTest("7÷6÷=", "", "1");

      doTest("1÷1÷2=", "", "0,5");
      doTest("6÷2÷2=", "", "1,5");
      doTest("1÷7÷3=", "", "0,0476190476190476");
      doTest("0÷2÷8=", "", "0");
      doTest("5÷9÷3=", "", "0,1851851851851852");

      doTest("2÷4=÷5", "0,5 ÷ ", "5");
      doTest("3÷3=÷7", "1 ÷ ", "7");
      doTest("5÷9=÷6", "0,5555555555555556 ÷ ", "6");
      doTest("8÷5=÷4", "1,6 ÷ ", "4");
      doTest("7÷1=÷3", "7 ÷ ", "3");

      doTest("7÷5=÷", "1,4 ÷ ", "1,4");
      doTest("4÷3=÷", "1,333333333333333 ÷ ", "1,333333333333333");
      doTest("2÷2=÷", "1 ÷ ", "1");
      doTest("8÷8=÷", "1 ÷ ", "1");
      doTest("6÷1=÷", "6 ÷ ", "6");

      doTest("3÷1=÷=", "", "1");
      doTest("5÷5=÷=", "", "1");
      doTest("8÷3=÷=", "", "1");
      doTest("4÷8=÷=", "", "1");
      doTest("1÷4=÷=", "", "1");

      doTest("5n÷3=", "", "-1,666666666666667");
      doTest("1n÷4=", "", "-0,25");
      doTest("6n÷2=", "", "-3");
      doTest("8n÷7=", "", "-1,142857142857143");
      doTest("7n÷6=", "", "-1,166666666666667");

      doTest("4÷4n=", "", "-1");
      doTest("2÷7n=", "", "-0,2857142857142857");
      doTest("8÷3n=", "", "-2,666666666666667");
      doTest("2÷6n=", "", "-0,3333333333333333");
      doTest("4÷7n=", "", "-0,5714285714285714");

      doTest("0.1÷1=", "", "0,1");
      doTest("2.5÷5=", "", "0,5");
      doTest("8.2÷9=", "", "0,9111111111111111");
      doTest("4.3÷4=", "", "1,075");
      doTest("7.5÷6=", "", "1,25");

      doTest("7÷1.2=", "", "5,833333333333333");
      doTest("2÷3.5=", "", "0,5714285714285714");
      doTest("4÷5.6=", "", "0,7142857142857143");
      doTest("5÷7.8=", "", "0,641025641025641");
      doTest("3÷9.1=", "", "0,3296703296703297");
   }

   @Test
   void equalsTests() {
      doTest("=", "", "0");
      doTest("+=", "", "0");
      doTest("3=", "", "3");
      doTest("√=", "", "0");
      doTest("%=", "", "0");
      doTest("n=", "", "0");
      doTest("2+3=+++", "5 + ", "5");
      doTest("239×4=+-×÷", "956 ÷ ", "956");
      doTest("10+=", "", "20");
      doTest("10+=+=", "", "40");
      doTest("10+=+=+=", "", "80");
      doTest("7+3=1+", "1 + ", "1");
      doTest("2+3=4===", "", "13");
      doTest("1+2=4=", "", "6");
      doTest("1+3===", "", "10");
      doTest("289-102===", "", "-17");
      doTest("2×3===", "", "54");
      doTest("188÷2===", "", "23,5");
      doTest("5+3=", "", "8");

      doTest("4√=", "", "2");
      doTest("8 SQR =", "", "64");
      doTest("2 1/x =", "", "0,5");
      doTest("5+3= 1/x ", "1/(8)", "0,125");
      doTest("3=6+", "6 + ", "6");
      doTest("2=+", "2 + ", "2");
   }

   @Test
   void mixOfOperations() {
      doTest("300+5=%√-1000000000000000= SQR + 9999999999999999 1/x × 1000000000000000 ÷ 50 ", "sqr(-999999999999964,5) + 1/(9999999999999999) × 1000000000000000 ÷ ","50");
      doTest("400 + % × 123.3 √ 1/x ÷ 55 × 12253 + 124n - 73 CE 81", "400 + 1600 × 1/(√(123,3)) ÷ 55 × 12253 + -124 - ","81");
      doTest("0.01 × 123 + % = √ SQR + 20 1/x ÷ 7.1 - % + 876 CE 765n ", "sqr(√(1,245129)) + 1/(20) ÷ 7,1 - 3,40562592057925e-4 + ", "-765");
      doTest("82 + 1 - 23 C 210 + n × 67.0987 SQR 1/x ÷ 8", "210 + negate(210) × 1/(sqr(67,0987)) ÷ ", "8");
      doTest("1 + 34 = C 123 n + 3 % * -100 + √ × 123.4 + 6 SQR - 90 1/x", "-123 + -3,69 - 100 + √(123,4) + sqr(6) - 1/(90)", "0,0111111111111111");

      doTest("12 - 52 C 123 <<< + 125.4 1/x + 23 SQR - 89 √ × 71 - 1n %", "0 + 1/(125,4) + sqr(23) - √(89) × 71 - -368,8975352782175", "-368,8975352782175");
      doTest("25 × 12 C 234 + 34 < 5 1/x + 32 SQR × 250 √ + ÷ % %", "234 + 1/(35) + sqr(32) × √(250) ÷ 787012312,5580016", "787 012 312,5580016");
      doTest("234 ÷ 2 C 8765 - << 76 = SQR SQR + 1/x - 234 √ + × 123", "sqr(sqr(8689)) + 1/(5700056872635765) - √(234) × ", "123");
      doTest("12 + C 234 CE 324 - 1/x + 876 SQR × 637 √ %", "324 - 1/(324) + sqr(876) × 193758,7192131822", "193 758,7192131822");
      doTest("83 + 2 = C 21 - √ × 90 SQR + 8 1/x - % ", "21 - √(21) × sqr(90) + 1/(8) - 176840160,0876563", "176 840 160,0876563");

      doTest("200+4% 1/x 1/x SQR √", "200 + √(sqr(1/(1/(8))))", "8");
      doTest("1÷3= 1/x ", "1/(0,3333333333333333)","3");
   }

   @Test
   void negateTest() {
      doTest("1n", "", "-1");
      doTest("2n", "", "-2");
      doTest("7n", "", "-7");
      doTest("132n", "", "-132");
      doTest("165n", "", "-165");

      doTest("1.04n", "", "-1,04");
      doTest("100.0n", "", "-100,0");
      doTest("13.2n", "", "-13,2");
      doTest("14.4n", "", "-14,4");
      doTest("31.2n", "", "-31,2");

      doTest("5nn", "", "5");
      doTest("3nn", "", "3");
      doTest("4nn", "", "4");
      doTest("5nn", "", "5");
      doTest("123nn", "", "123");

      doTest("5+n", "5 + negate(5)", "-5");
      doTest("21+n", "21 + negate(21)", "-21");
      doTest("14+n", "14 + negate(14)", "-14");
      doTest("3+n", "3 + negate(3)", "-3");
      doTest("7+n", "7 + negate(7)", "-7");

      doTest("43+n=", "", "0");
      doTest("0.4+n=", "", "0");
      doTest("3+n=", "", "0");
      doTest("8+n=", "", "0");
      doTest("7+n=", "", "0");
   }

   @Test
   void squareTest() {
     doTest("SQR", "sqr(0)", "0");

     doTest("0 SQR", "sqr(0)", "0");
     doTest("1 SQR", "sqr(1)", "1");
     doTest("2 SQR", "sqr(2)", "4");
     doTest("5 SQR", "sqr(5)", "25");

     doTest("5n SQR", "sqr(-5)", "25");
     doTest("2n SQR", "sqr(-2)", "4");
     doTest("6n SQR", "sqr(-6)", "36");
     doTest("4n SQR", "sqr(-4)","16");

     doTest("5 SQR +", "sqr(5) + ", "25");
     doTest("2 SQR -", "sqr(2) - ", "4");
     doTest("6 SQR ×", "sqr(6) × ", "36");
     doTest("8 SQR ÷", "sqr(8) ÷ ", "64");

     doTest("5n SQR +", "sqr(-5) + ", "25");
     doTest("1n SQR -", "sqr(-1) - ", "1");
     doTest("7n SQR ×", "sqr(-7) × ", "49");
     doTest("9n SQR ÷", "sqr(-9) ÷ ", "81");

     doTest("3 SQR +2", "sqr(3) + ", "2");
     doTest("4 SQR -5", "sqr(4) - ", "5");
     doTest("6 SQR ×6", "sqr(6) × ", "6");
     doTest("8 SQR ÷7", "sqr(8) ÷ ", "7");

     doTest("2 SQR SQR", "sqr(sqr(2))", "16");
     doTest("2 SQR SQR SQR", "sqr(sqr(sqr(2)))", "256");
     doTest("2√ SQR √ SQR √ SQR", "sqr(√(sqr(√(sqr(√(2))))))", "2");
     doTest("3 SQR +2 SQR ", "sqr(3) + sqr(2)", "4");
     doTest("3 SQR +2 SQR =", "", "13");
     doTest("3 SQR +7=", "", "16");
     doTest("5+ SQR SQR", "5 + sqr(sqr(5))", "625");
     doTest("5+ SQR SQR =", "", "630");
     doTest("2+3= SQR", "sqr(5)", "25");


      doTest("0.0000000000000001 SQR ", "sqr(0,0000000000000001)", "1,e-32");
      doTest("0.0000000000000001 SQR SQR ", "sqr(sqr(0,0000000000000001))", "1,e-64");
      doTest("0.0000000000000001n= SQR ", "sqr(-0,0000000000000001)", "1,e-32");
      doTest("0-0.0000000000000001= SQR ", "sqr(-0,0000000000000001)", "1,e-32");
      doTest("9999999999999999 SQR ", "sqr(9999999999999999)", "9,999999999999998e+31");
      doTest("9999999999999999 SQR SQR ", "sqr(sqr(9999999999999999))", "9,999999999999996e+63");
   }

   @Test
   void squareRootTest() {
      doTest("0√", "√(0)", "0");
      doTest("4√", "√(4)", "2");
      doTest("4√√", "√(√(4))", "1,414213562373095");
      doTest("4√√√", "√(√(√(4)))", "1,189207115002721");
      doTest("4√√√=", "", "1,189207115002721");
      doTest("3+4√=", "", "5");
      doTest("4+√", "4 + √(4)", "2");
      doTest("4+1+1+1+√", "4 + 1 + 1 + 1 + √(7)","2,645751311064591");
      doTest("121√", "√(121)", "11");
      doTest("456√", "√(456)", "21,35415650406262");
      doTest("2875√", "√(2875)", "53,61902647381804");
      doTest("1785√", "√(1785)", "42,24926034855522");
      doTest("2134√", "√(2134)", "46,19523784980439");
      doTest("4+5=√", "√(9)", "3");
      doTest("4+5=√=", "", "8");

      doTest("0.0000000000000001√", "√(0,0000000000000001)", "0,00000001");
      doTest("0.0000000000000001√√", "√(√(0,0000000000000001))", "0,0001");

      doTest("9999999999999999√", "√(9999999999999999)", "100 000 000");
   }

   @Test
   void divideByTest() {
      doTest(" 1/x ", "1/(0)", "Cannot divide by zero");

      doTest("1 1/x", "1/(1)", "1");
      doTest("2 1/x", "1/(2)", "0,5");
      doTest("10 1/x", "1/(10)", "0,1");
      doTest("1.1 1/x", "1/(1,1)", "0,9090909090909091");

      doTest("5 1/x +", "1/(5) + ", "0,2");
      doTest("2 1/x -", "1/(2) - ", "0,5");
      doTest("6 1/x ×", "1/(6) × ", "0,1666666666666667");
      doTest("9 1/x ÷", "1/(9) ÷ ", "0,1111111111111111");

      doTest("10 + 1/x ", "10 + 1/(10)", "0,1");
      doTest("21 - 1/x ", "21 - 1/(21)", "0,0476190476190476");
      doTest("32 × 1/x ", "32 × 1/(32)", "0,03125");
      doTest("42 ÷ 1/x ", "42 ÷ 1/(42)", "0,0238095238095238");

      doTest("10+12= 1/x ", "1/(22)", "0,0454545454545454");
      doTest("12+43= 1/x ", "1/(55)", "0,0181818181818182");
      doTest("21+36= 1/x ", "1/(57)", "0,0175438596491228");
      doTest("83+37= 1/x ", "1/(120)", "0,0083333333333333");

      doTest("1000000000000000- 1/x", "1000000000000000 - 1/(1000000000000000)", "0,000000000000001");
      doTest("1000000000000000×=- 1/x", "1,e+30 - 1/(1,e+30)", "1,e-30");
      doTest("1000000000000000×=====- 1/x", "1,e+90 - 1/(1,e+90)", "1,e-90");

      doTest("0.0000000000000001 1/x ", "1/(0,0000000000000001)", "1,e+16");
      doTest("0.0000000000000001 1/x 1/x ", "1/(1/(0,0000000000000001))", "0,0000000000000001");

      doTest("9999999999999999 1/x ", "1/(9999999999999999)", "1,e-16");
      doTest("9999999999999999 1/x 1/x ", "1/(1/(9999999999999999))", "9 999 999 999 999 999");
   }

   @Test
   void percentTest() {
      doTest("%", "0", "0");

      doTest("2%", "0", "0");
      doTest("168%", "0", "0");
      doTest("25%", "0", "0");
      doTest("7%%", "0", "0");

      doTest("6n%", "0", "0");
      doTest("2n%", "0", "0");
      doTest("4n%", "0", "0");
      doTest("5n%", "0", "0");

      doTest("10%%%=", "", "0");
      doTest("32%%%=", "", "0");
      doTest("41%%%=", "", "0");
      doTest("12%%%=", "", "0");

      doTest("200+2%", "200 + 4", "4");
      doTest("152+3%", "152 + 4,56", "4,56");
      doTest("234+4%", "234 + 9,36", "9,36");
      doTest("543+5%", "543 + 27,15", "27,15");

      doTest("5+%", "5 + 0,25", "0,25");
      doTest("1+%", "1 + 0,01", "0,01");
      doTest("3+%", "3 + 0,09", "0,09");
      doTest("4+%", "4 + 0,16", "0,16");

      doTest("200+2%=", "", "204");
      doTest("152+3%=", "", "156,56");
      doTest("234+4%=", "", "243,36");
      doTest("543+5%=", "", "570,15");

      doTest("200+2%=%", "416,16", "416,16");
      doTest("152+3%=%", "245,110336", "245,110336");
      doTest("234+4%=%", "592,240896", "592,240896");
      doTest("543+5%=%", "3250,710225", "3 250,710225");

      doTest("199+1=%", "400", "400");
      doTest("199+1=%%", "800", "800");
      doTest("199+1=%%%", "1600", "1 600");
      doTest("199+1=%%%%", "3200", "3 200");

      doTest("200+25%%%%%%%%%", "200 + 12800", "12 800");
      doTest("200+25%%%%%%%%%=", "", "13 000");
      doTest("300n+15%=", "", "-345");
      doTest("245+63n%=", "", "90,65");
   }

   @Test
   void backspaceTest() {
      doTest("2 SQR SQR SQR <<<<<<<<=", "", "256");
      doTest("70÷7=<<<", "", "10");
      doTest("1234567890<<<<<<<<<<<<<<<<<<<<<=", "", "0");
      doTest("<<<<2√ SQR =", "", "2");
      doTest("2+3=<<<<", "", "5");

      doTest("<", "", "0");
      doTest(".", "", "0,");
      doTest("...", "", "0,");
      doTest(".<", "", "0");
      doTest("...<<<", "", "0");
      doTest("...<", "", "0");
      doTest("<.", "", "0,");
      doTest("<...", "", "0,");

      doTest("<0", "", "0");
      doTest("0<", "", "0");
      doTest("000000<<<<<", "",  "0");
      doTest("0.0001<", "", "0,000");
      doTest("0.0<", "", "0,");
      doTest("1.0<", "", "1,");
      doTest("1.01<", "", "1,0");
      doTest("12.0<", "", "12,");
      doTest("12.0<<", "","12");
      doTest("12.0<<<", "", "1");
      doTest("12.0<<<<", "", "0");
      doTest("<<<1234.12345", "", "1 234,12345");
      doTest("1234.12345<<<", "", "1 234,12");
      doTest("1234.12345<<<<", "", "1 234,1");
      doTest("1234.12345<<<<<", "", "1 234,");
      doTest("1234.12345<<<<<<", "", "1 234");
      doTest("1234.12345<<<<<<<", "", "123");

      doTest("1000000000000000.", "", "1 000 000 000 000 000,");
      doTest("1000000000000000.<", "", "1 000 000 000 000 000");
      doTest("1000000000000000.<.00", "", "1 000 000 000 000 000,");
      doTest("1000000000000000.<.10", "", "1 000 000 000 000 000,");
      doTest("1000000000000000.<0", "", "1 000 000 000 000 000");
   }

   @Test
   void clear() {
      doTest("C", "", "0");

      doTest("4 C", "", "0");
      doTest("1 C", "", "0");
      doTest("3 C", "", "0");
      doTest("4 C", "", "0");

      doTest("42 C 12", "", "12");
      doTest("85 C 47", "", "47");
      doTest("78 C 65", "", "65");
      doTest("96 C 32", "", "32");

      doTest("96 C 32 C", "", "0");
      doTest("75 C 76 C", "", "0");
      doTest("95 C 43 C", "", "0");
      doTest("32 C 16 C", "", "0");

      doTest("32 + C 16 - ", "16 - ", "16");
      doTest("75 - C 21 × ", "21 × ", "21");
      doTest("65 × C 82 ÷ ", "82 ÷ ", "82");
      doTest("32 ÷ C 10 + ", "10 + ", "10");

      doTest("+ C ÷", "0 ÷ ", "0");
      doTest("- C ×", "0 × ", "0");
      doTest("× C -", "0 - ", "0");
      doTest("÷ C +", "0 + ", "0");

      doTest("2 + 7 C 8 ÷ 2 C", "", "0");
      doTest("2 - 7 C 8 × 2 C", "", "0");
      doTest("2 × 7 C 8 - 2 C", "", "0");
      doTest("2 ÷ 7 C 8 + 2 C", "", "0");

      doTest("2+2×2-6×3-10 C", "", "0");
      doTest("2+5÷2 C C C C C C C C C", "", "0");
      doTest("5 SQR SQR SQR SQR SQR SQR √√ SQR SQR SQR SQR SQR√ SQR SQR SQR C C", "", "0");
   }

   @Test
   void testClearEntry() {
      doTest(" CE ","", "0");

      doTest("5 CE ","", "0");
      doTest("85 CE", "", "0");
      doTest("894 CE", "", "0");
      doTest("1245 CE", "", "0");

      doTest("1245 CE 45", "", "45");
      doTest("9845 CE 23", "", "23");
      doTest("1889 CE 87", "", "87");
      doTest("4651 CE 62", "", "62");

      doTest("4651 CE 21 CE ", "", "0");
      doTest("7621 CE 45 CE ", "", "0");
      doTest("9276 CE 32 CE ", "", "0");
      doTest("4628 CE 70 CE ", "", "0");

      doTest("1+2÷3 CE 9", "1 + 2 ÷ ", "9");
      doTest("1-2×3 CE 9", "1 - 2 × ", "9");
      doTest("1×2-3 CE 9", "1 × 2 - ", "9");
      doTest("1÷2+3 CE 9", "1 ÷ 2 + ", "9");

      doTest("1 CE 5 CE 8 + 2 CE 6 ÷ 1 CE 5", "8 + 6 ÷ ", "5");
      doTest("2 CE 6 CE 9 - 3 CE 7 × 2 CE 6", "9 - 7 × ", "6");
      doTest("3 CE 7 CE 0 × 4 CE 8 - 3 CE 7", "0 × 8 - ", "7");
      doTest("4 CE 8 CE 1 ÷ 5 CE 9 + 4 CE 8", "1 ÷ 9 + ", "8");
   }

   @Test
   void testRoundingMode() {
      doTest("0.0000000000000001+1=", "", "1");
      doTest("1÷3×3=", "", "1");
      doTest("1÷3×3-1", "1 ÷ 3 × 3 - ", "1");
      doTest("0.0111111111111111×0.1=", "", "0,0011111111111111");
      doTest("0.0111111111111111×0.1==", "", "1,11111111111111e-4");
      doTest("0.0111111111111111×0.1===", "", "1,11111111111111e-5");
      doTest("1÷3×3-1=", "", "0");
      doTest("2.0000000000000001+1========", "", "10");
      doTest("0.1×================", "", "1,e-17");
      doTest("0.9×=================================================================", "", "9,550049507968252e-4");
      doTest("9999999999999999+2=", "", "1,e+16");
      doTest("9999999999999999×2=", "", "2,e+16");
      doTest("9999999999999999×8=", "", "7,999999999999999e+16");
      doTest("9999999999999999×8==", "", "6,399999999999999e+17");
      doTest("9999999999999999×8===", "", "5,119999999999999e+18");
      doTest("9999999999999999×8====", "", "4,096e+19");
      doTest("9999999999999999×6=", "", "5,999999999999999e+16");
      doTest("9999999999999999×6==", "", "3,6e+17");
      doTest("9999999999999999×6===", "", "2,16e+18");
      doTest("9999999999999999×6====", "", "1,296e+19");
      doTest("9999999999999999×6=====", "", "7,775999999999999e+19");
      doTest("9999999999999999+6=", "", "1,e+16");
      doTest("9999999999999999+7=", "", "1,000000000000001e+16");
      doTest("9999999999999999 1/x +1=", "", "1");
      doTest("9999999999999999 1/x =", "", "1,e-16");
      doTest("9999999999999999 1/x +=", "", "2,e-16");
      doTest("9999999999999999 1/x +==", "", "3,e-16");
      doTest("9999999999999999 1/x +===", "", "4,e-16");
      doTest("9999999999999999 1/x +====", "", "5,000000000000001e-16");
      doTest("2.000000000000001+1=", "", "3,000000000000001");
      doTest("2.000000000000001+2=", "", "4,000000000000001");
      doTest("2.000000000000001+3=", "", "5,000000000000001");
      doTest("2.000000000000001+4=", "", "6,000000000000001");
      doTest("2.000000000000001+8=", "", "10");

      doTest("0.0000000000000001+=", "", "0,0000000000000002");
      doTest("0.0000000000000001-=", "", "0");
      doTest("1÷7×7-1=", "", "0");
      doTest("1÷7×1000000000000000×7-1000000000000000=", "", "0");
      doTest("1÷3÷7÷11÷13÷17×1000000000000000×3×7×11×13×17-1000000000000000=", "", "0");
      doTest("5√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√", null, "1,000000000000002");
      doTest("1÷3×0.0000000000000001×0.00000000001×1000000000000000×10000000000000×3=", "", "10");
      doTest("0.9999999999999999×999999999999999.1=", "", "999 999 999 999 999");
      doTest("0.9999999999999999×999999999999999.3=", "", "999 999 999 999 999,2");
      doTest("0.9999999999999999×999999999999999.5=", "", "999 999 999 999 999,4");
      doTest("0.9999999999999999×999999999999999.7=", "", "999 999 999 999 999,6");
      doTest("0.9999999999999999×99999999999999.11=", "", "99 999 999 999 999,1");

      doTest("10÷3==×1000000000000000========", "", "1,111111111111111e+120");
   }

   @Test
   void buildOperandTest() {
      doTest("1", "", "1");
      doTest("2", "", "2");
      doTest("3", "", "3");
      doTest("4", "", "4");
      doTest("5", "", "5");
      doTest("6", "", "6");
      doTest("7", "", "7");
      doTest("8", "", "8");
      doTest("9", "", "9");

      doTest("0000000000000000000000000000000000000001", "", "1");
      doTest("01010111101010101000011", "", "1 010 111 101 010 101");
      doTest("123456789", "", "123 456 789");
      doTest("1000000000000000000", "", "1 000 000 000 000 000");
      doTest("1000000000000000000.", "", "1 000 000 000 000 000,");
      doTest("9999999999999999999.", "", "9 999 999 999 999 999,");
      doTest("1234567890123456789", "", "1 234 567 890 123 456");

      doTest("3.0", "", "3,0");
      doTest("3.00", "", "3,00");
      doTest("0.00000000000000000", "", "0,0000000000000000");
      doTest("3.00000000000000000", "", "3,000000000000000");
      doTest("3.000000000000000001", "", "3,000000000000000");
      doTest("10.000000000000000001", "", "10,00000000000000");
      doTest("100.000000000000000001", "", "100,0000000000000");
      doTest("1000.000000000000000001", "", "1 000,000000000000");
      doTest("100000000000000.000000000000000001", "", "100 000 000 000 000,0");
      doTest("1000000000000000.000000000000000001", "", "1 000 000 000 000 000,");
   }

   @Test
   void historyTest() {
      doTest("0.0000000000000001+", "0,0000000000000001 + ", "0,0000000000000001");
      doTest("0.0000000000000001+1", "0,0000000000000001 + ", "1");
      doTest("0.0000000000000001+1=", "", "1");
      doTest("0.0000000000000001+1=+", "1 + ", "1");
      doTest("0.0000000000000001+1=+=+", "2 + ", "2");
      doTest("0.0000000000000001+1=+=+=+", "4 + ", "4");
      doTest("0.0000000000000001+1=+=+=+=+", "8,000000000000001 + ", "8,000000000000001");

      doTest("2+5 SQR ", "2 + sqr(5)", "25");
      doTest("1.00001√√√", "√(√(√(1,00001)))", "1,000001249994531");
   }

   @Test
   void memoryTest() {
      doTest("MR", "","0");
      doTest("M+ MR", "","0");
      doTest("M- MR", "","0");

      // takes from operand
      doTest("4 M+ MR ", "", "4");
      doTest("4 M+ M+ MR ", "", "8");
      doTest("4n M+ MR ", "", "-4");
      doTest("4n M+ M+ MR ", "", "-8");

      doTest("4 M- MR ", "", "-4");
      doTest("4 M- M- MR ", "", "-8");
      doTest("4n M- MR ", "", "4");
      doTest("4n M- M- MR ", "", "8");

      doTest("0 M- MR ", "", "0");
      doTest("0 M- M- MR ", "", "0");
      doTest("0n M- MR ", "", "0");
      doTest("0n M- M- MR ", "", "0");

      doTest("0 M+ MR ", "", "0");
      doTest("0 M+ M+ MR ", "", "0");
      doTest("0n M+  MR ", "", "0");
      doTest("0n M+ M+ MR ", "", "0");

      doTest(". M+ MR", "", "0");
      doTest("0. M+ MR", "", "0");
      doTest(".n M+ MR", "", "0");
      doTest("0.n M+ MR", "", "0");

      doTest(". M- MR", "", "0");
      doTest("0. M- MR", "", "0");
      doTest(".n M- MR", "", "0");
      doTest("0.n M- MR", "", "0");

      doTest("1 M+ M+ ÷ MR =", "", "0,5");
      doTest("2 M+ M+ × MR =", "", "8");
      doTest("3 M+ M+ - MR =", "", "-3");
      doTest("4 M+ M+ + MR =", "", "12");

      doTest("1 M- M- ÷ MR =", "", "-0,5");
      doTest("2 M- M- × MR =", "", "-8");
      doTest("3 M- M- - MR =", "", "9");
      doTest("4 M- M- + MR =", "", "-4");

      doTest("1 M+ M+ M+ M+ MR =", "", "4");
      doTest("2 M+ M+ M+ M- MR =", "", "4");
      doTest("3 M+ M+ M- M- MR =", "", "0");
      doTest("4 M+ M- M- M- MR =", "", "-8");

      // takes from result
      doTest("1+2-3×4÷5+ M+ MR =", "", "0");
      doTest("1-2×3÷4+5+ M+ MR =", "", "8,5");
      doTest("1×2÷3+4+5- M+ MR =", "", "0");
      doTest("1÷2+3+4-5× M+ MR =", "", "6,25");

      doTest("2+2= M+ M+ M+ M+ MR + 0=", "", "16");
      doTest("1+5= M+ M+ M+ M+ MR + 0=", "", "24");
      doTest("3+6= M+ M+ M+ M+ MR + 0=", "", "36");
      doTest("4+7= M+ M+ M+ M+ MR + 0=", "", "44");

      doTest("0 + 20 M- M- M- M- M- =- MR =", "", "120");
      doTest("1 + 21 M- M- M- M- M- =+ MR =", "", "-83");
      doTest("2 + 22 M- M- M- M- M- =× MR =", "", "-2 640");
      doTest("3 + 23 M- M- M- M- M- =÷ MR =", "", "-0,2260869565217391");

      doTest("0,0000000000000001 SQR SQR SQR SQR SQR SQR M+ √√√√ SQR SQR SQR SQR M- MR ", "sqr(sqr(sqr(sqr(√(√(√(√(sqr(sqr(sqr(sqr(sqr(sqr(1))))))))))))))", "0");
      doTest("0,0000000000000001 SQR SQR SQR SQR SQR SQR M+ √√√√ SQR SQR SQR SQR M- MR =", "", "0");

      doTest("1000000000000000×1000000000000000×1000000000000000= M- C 1÷7×1000000000000000×1000000000000000×1000000000000000×7= M+ C MR=", "", "0");
      doTest("1000000000000000×1000000000000000×1000000000000000= M- C 1÷3×1000000000000000×1000000000000000×1000000000000000×3= M+ C MR=", "", "0");
      doTest("1000000000000000×1000000000000000×1000000000000000= M- C 1÷5×1000000000000000×1000000000000000×1000000000000000×5= M+ C MR=", "", "0");
      doTest("1000000000000000×1000000000000000×1000000000000000= M- C 1÷1×1000000000000000×1000000000000000×1000000000000000×11= M+ C MR=", "", "0");
   }

   @Test
   void checkExceptions() {
      // overflow
      doTest("1000000000000000 SQR SQR SQR SQR SQR SQR SQR SQR SQR SQR", "sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(1000000000000000))))))))))", "Overflow");
      doTest("1000000000000000×=×=×=×=×=×=×=×=×=×=", "1,e+7680 × ", "Overflow");
      doTest("-1000000000000000×=×=×=×=×=×=×=×=×=×=", "1,e+7680 × ", "Overflow");

      doTest("0.0000000000000001 SQR SQR SQR SQR SQR SQR SQR SQR SQR SQR", "sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(0,0000000000000001))))))))))", "Overflow");
      doTest("0.0000000000000001 ×=×=×=×=×=×=×=×=×=×=", "1,e-8192 × ", "Overflow");
      doTest("-0.0000000000000001 ×=×=×=×=×=×=×=×=×=×=", "1,e-8192 × ", "Overflow");

      // undefined
      doTest("0÷0=", "0 ÷ 0", "Result is undefined");
      doTest("0.0000000000000000÷0=", "0 ÷ 0", "Result is undefined");
      doTest("1-1 M+ MR ÷0=", "1 - 1 ÷ 0", "Result is undefined");
      doTest("0÷0+", "0 ÷ 0", "Result is undefined");

      doTest("2+2×2-8÷0=", "2 + 2 × 2 - 8 ÷ 0", "Result is undefined");
      doTest("2+4×6-36÷0=", "2 + 4 × 6 - 36 ÷ 0", "Result is undefined");
      doTest("5+1×8-48÷0=", "5 + 1 × 8 - 48 ÷ 0", "Result is undefined");
      doTest("9+4×3-39÷0=", "9 + 4 × 3 - 39 ÷ 0", "Result is undefined");

      // divide by zero
      doTest("1÷0=", "1 ÷ 0", "Cannot divide by zero");
      doTest("2n÷0=", "-2 ÷ 0", "Cannot divide by zero");
      doTest("3÷0=", "3 ÷ 0", "Cannot divide by zero");
      doTest("0.0000000000000001÷0=", "0,0000000000000001 ÷ 0", "Cannot divide by zero");

      doTest("2+1-10×2÷0=", "2 + 1 - 10 × 2 ÷ 0", "Cannot divide by zero");
      doTest("3+6-32×3÷0=", "3 + 6 - 32 × 3 ÷ 0", "Cannot divide by zero");
      doTest("4+7-34×6÷0=", "4 + 7 - 34 × 6 ÷ 0", "Cannot divide by zero");
      doTest("5+8-84×9÷0=", "5 + 8 - 84 × 9 ÷ 0", "Cannot divide by zero");

      doTest("0 1/x ", "1/(0)", "Cannot divide by zero");
      doTest("8÷0=", "8 ÷ 0", "Cannot divide by zero");

      // invalid input
      doTest("5n√", "√(-5)", "Invalid input");
      doTest("50-45-500√=√", "√(-17,3606797749979)", "Invalid input");
      doTest("0.4565468n√", "√(-0,4565468)", "Invalid input");
      doTest("-0.57894=√", "√(-0,57894)", "Invalid input");
   }

   @Test
   void boundaryTest() {

      // this pattern reach to number: 2e-9999 and write it as a result.
      String doubleSmallNumber = "1000000000000000×===================×================================×1000000000000000======" +
              "×10========= 1/x ×0.2= ";

      // this pattern reach to number: 1e-9999 and write it as a result.
      String smallNumber = "1000000000000000×===================×================================×1000000000000000======" +
              "×10========= 1/x ×0.1= ";

      // this pattern create number by this short formula (MAX - 1).
      // number must be 99999999...
      // digit 9 must be 10 000 times.
      String maxMinusOne = "1000000000000000×===================×================================×1000000000000000======" +
              "×10========= -1×10+9=";

      // this pattern provide to storage in memory this number : 0.9999999999999999999..94
      // note! digit 9 must be 19999 times and at the end of this number must be digit 4
      String oneSubtractTheSmallestNumber = smallNumber + " M+ C " + "1000000000000000×===================×================================×1000000000000000======" +
              "×10========= -1= 1/x - MR ×0.1=-0.9=×0.6=-0.4=n MC M+ C ";

      // this pattern create number by this short formula (-MAX - MIN).
      // number must be -99999999...
      // digit 9 must be 10 000 times.
      String negateMaxSubtractMin = "1000000000000000×===================×================================×1000000000000000======" +
              "×10========= -1×10n-9= ";


      String theMaxNumber = oneSubtractTheSmallestNumber + maxMinusOne + "+ MR =";

      String theMinNumber = oneSubtractTheSmallestNumber + negateMaxSubtractMin + " - MR =";

      // right side
      // 999999..9,999999999...94
      doTest(theMaxNumber, null, "1,e+10000");

      // 1e10000
      doTest(theMaxNumber + " MC M+ C " + smallNumber + " + MR = ", null, "Overflow");

      // 1e10001
      doTest(theMaxNumber + " MC M+ C " + doubleSmallNumber + " + MR = ", null, "Overflow");

      // gets 1.000000000000001e-10000 number
      doTest(smallNumber + "×0.1000000000000001=", null, "1,000000000000001e-10000");

      // gets 1-10000
      doTest(smallNumber + "×0.1=", null, "Overflow");

      // gets 9.999999999999999e-10001 number
      doTest(smallNumber + "×0.0999999999999999=", null, "Overflow");

      // left side
      // -9999..9,999999999...94
      doTest(theMinNumber, null, "-1,e+10000");

      // -1e10000
      doTest(theMinNumber + " MC M+ C " + smallNumber + " ×1n + MR = ", null, "Overflow");

      // -1e10001
      doTest(theMinNumber + " MC M+ C " + doubleSmallNumber + " ×1n + MR = ", null, "Overflow");

      // gets -1.000000000000001e-10000 number
      doTest(smallNumber + " ×0.1000000000000001n= ", null, "-1,000000000000001e-10000");

      // gets -1-10000
      doTest(smallNumber + "M+ C 0 - MR =" + "×0.1=", null, "Overflow");

      // gets -1.000000000000001e-10001 number
      doTest(smallNumber + "M+ C 0 - MR =" + "×0.0999999999999999=", null, "Overflow");
   }
   
   @Test
   void boundaryTestForSpecialOperations() {
      doTest("1000000000000000 SQR SQR SQR SQR SQR SQR SQR SQR SQR", "sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(1000000000000000)))))))))", "1,e+7680");
      doTest("1000000000000000 SQR SQR SQR SQR SQR SQR SQR SQR SQR SQR", "sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(1000000000000000))))))))))", "Overflow");
      doTest("1000000000000000 SQR SQR SQR SQR SQR SQR SQR SQR SQR SQR SQR", "sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(1000000000000000))))))))))", "Overflow");
      doTest("1000000000000000 SQR SQR SQR SQR SQR SQR SQR SQR SQR SQR SQR SQR SQR SQR SQR ","sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(1000000000000000))))))))))", "Overflow");

      doTest("0.0000000000000001 SQR SQR SQR SQR SQR SQR SQR SQR SQR", "sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(0,0000000000000001)))))))))", "1,e-8192");
      doTest("0.0000000000000001 SQR SQR SQR SQR SQR SQR SQR SQR SQR SQR ", "sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(0,0000000000000001))))))))))", "Overflow");
      doTest("0.0000000000000001 SQR SQR SQR SQR SQR SQR SQR SQR SQR SQR SQR ", "sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(0,0000000000000001))))))))))", "Overflow");
      doTest("0.0000000000000001 SQR SQR SQR SQR SQR SQR SQR SQR SQR SQR SQR SQR SQR SQR SQR ", "sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(sqr(0,0000000000000001))))))))))", "Overflow");

      doTest("1000000000000000 √√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√", null,"1,000000000000001");
      doTest("1000000000000000 √√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√", null,"1");
      doTest("1000000000000000 √√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√", null,"1");
      doTest("1000000000000000 √√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√", null,"1");

      doTest("0.0000000000000001 √√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√", null,"0,9999999999999999");
      doTest("0.0000000000000001 √√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√", null,"1");
      doTest("0.0000000000000001 √√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√", null,"1");
      doTest("0.0000000000000001 √√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√√", null,"1");
      
      doTest("10000000000000000×=================== %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%", "1,e+9836", "1,e+9836");
      doTest("10000000000000000×=================== %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%", "1,e+10134", "Overflow");
      doTest("10000000000000000×=================== %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%", "1,e+10134", "Overflow");

      doTest("0.000000000000001×=================== %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%", "1,e-9964","1,e-9964");
      doTest("0.000000000000001×=================== %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%", "1,e-10266", "Overflow");
      doTest("0.000000000000001×=================== %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%", "1,e-10266", "Overflow");
   }
}
